function d(){return new URLSearchParams(window.location.search).get("v")}async function p(n){try{const e=(await(await fetch("http://localhost:5000/api/summarize",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({videoId:n,targetLang:"fr"})})).json()).summary.split(`
`).filter(r=>!!r);return{summary:e,actions:e.filter(r=>r.toLowerCase().includes("action")),chapters:e.filter(r=>r.toLowerCase().includes("chapitre"))}}catch(t){return console.error("Erreur lors de la rÃ©cupÃ©ration du rÃ©sumÃ© :",t),null}}function m(n){const t=document.createElement("li");t.style.marginBottom="4px",t.style.overflow="hidden",t.style.textOverflow="ellipsis",t.style.whiteSpace="normal",t.style.display="-webkit-box",t.style.webkitBoxOrient="vertical",t.style.webkitLineClamp="2";const o=n.match(/^\s*[-â€¢]?\s*(\*\*.+?\*\*)(.*)/);if(o){const e=o[1].replace(/\*\*/g,"").trim(),r=o[2].trim(),s=document.createElement("span");s.textContent=e+" ",s.style.fontWeight="500";const a=document.createElement("span");a.textContent=r,t.appendChild(document.createTextNode("â€¢ ")),t.appendChild(s),t.appendChild(a)}else t.textContent=`â€¢ ${n}`;return t}function u(){return getComputedStyle(document.documentElement).getPropertyValue("--yt-spec-base-background").trim()==="#0f0f0f"||window.matchMedia("(prefers-color-scheme: dark)").matches}function y(n,t,o){const e=document.createElement("div");return e.textContent=n,e.style.cursor="pointer",e.style.padding="8px 14px",e.style.borderRadius="8px",e.style.fontWeight="500",e.style.marginRight="8px",e.style.transition="all 0.2s ease-in-out",e.style.boxShadow=t?"0 1px 3px rgba(0,0,0,0.12)":"",e.style.backgroundColor=t?"#e6e6e6":"transparent",e.style.border=t?"1px solid #ccc":"1px solid transparent",e.onmouseenter=()=>{e.style.backgroundColor="#f0f0f0"},e.onmouseleave=()=>{e.style.backgroundColor=t?"#e6e6e6":"transparent"},e.onclick=()=>{var r;o(),[...((r=e.parentElement)==null?void 0:r.children)||[]].forEach(s=>{const a=s;a.style.backgroundColor="transparent",a.style.border="1px solid transparent",a.style.boxShadow=""}),e.style.backgroundColor="#e6e6e6",e.style.border="1px solid #ccc",e.style.boxShadow="0 1px 3px rgba(0,0,0,0.12)"},e}function h(n,t){const o=document.createElement("div");o.style.marginBottom="12px";const e=document.createElement("div");e.style.display="flex",e.style.flexWrap="wrap";const r={summary:"ðŸ§  Summary",actions:"ðŸ“Œ Actions",chapters:"ðŸ“… Chapters"},s=a=>{t.innerHTML="";const c=document.createElement("ul");n[a].forEach(l=>c.appendChild(m(l))),t.appendChild(c)};return Object.keys(n).forEach((a,c)=>{const l=r[a]||a,i=y(l,c===0,()=>s(a));e.appendChild(i)}),o.appendChild(e),{header:o,renderSection:s}}function b(n){const t=document.querySelector("#secondary");if(!t){console.warn("Zone secondaire introuvable !");return}const o=u(),e=document.createElement("div");e.style.background="var(--yt-spec-badge-chip-background)",e.style.borderRadius="12px",e.style.marginTop="24px",e.style.marginBottom="16px",e.style.padding="16px",e.style.fontFamily='"Roboto", "Arial", sans-serif',e.style.fontSize="1.4rem",e.style.lineHeight="2rem",e.style.fontWeight="400",e.style.color=o?"rgb(255, 255, 255)":"#000",e.style.boxShadow="0 2px 10px rgba(0, 0, 0, 0.08)";const r=document.createElement("div"),{header:s,renderSection:a}=h(n,r);e.appendChild(s);const c=document.createElement("div");c.style.height="1px",c.style.backgroundColor="#ddd",c.style.margin="10px 0",e.appendChild(c),e.appendChild(r),a("summary"),t.prepend(e)}function f(n,t){const o=new MutationObserver(()=>{const e=document.querySelector(n);e&&(o.disconnect(),t(e))});o.observe(document.body,{childList:!0,subtree:!0})}(async()=>{const n=d();if(!n)return;const t=await p(n);t&&f("#secondary",()=>b(t))})();
